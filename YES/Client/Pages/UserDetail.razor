@page "/CustomerDetail"
@inject ICustomerService customerService

<div class="page-background">

    @if (Customer != null)
    {
    <div class="row">
        <div class="col-xl-6 order-xl-2 mb-4">
            <section>
                <h3 class="mb-3">User Details </h3>
                <input @bind="CustomerId" /><button class="btn btn-outline-light" @onclick="() => GetUserWithId(CustomerId)">Get User</button>
                 <p>@Customer.FirstName @Customer.LastName</p>
                
                @*@if (Customer != null)
                {
                    <UserDetail Customer="Customer"></UserDetail>
                }*@               

            </section>
        </div>

        <div class="col-xl-6 order-xl-1">
            <section>
                <h3 class="mb-3">Ticket List</h3>

                @if (Tickets != null)
                {
                    <div class="row mb-4 ticket-overview-header">
                        <div class="col">
                            Purchased On
                        </div>
                        <div class="col">
                            Event Date
                        </div>
                        <div class="col">
                            Price
                        </div>
                
                        <div class="col">
                            Event Name
                        </div>
                        <div class="col">
                            Event Location
                        </div>

                    </div>
                    @foreach (var ticket in Customer.Tickets)
                    {
                        <div class="row ticket-item">
                            <TicketOverview Ticket="ticket"></TicketOverview>                            
                        </div>
                        
                    }

                }
            </section>
        </div>

    </div>
        
    }
    </div>
            

@code {
    [Parameter]
    public CustomerWithTicketsDto Customer { get; set; }

    public List<TicketDto> Tickets { get; set; }

    public int CustomerId { get; set; }

    protected async override Task OnInitializedAsync()
    {
        Customer = await customerService.GetCustomerByIdAsync(1);
        Tickets = Customer.Tickets.ToList();
    }

    private async Task GetUserWithId(int id)
    {
        Customer = await customerService.GetCustomerByIdAsync(id);
    }

}
